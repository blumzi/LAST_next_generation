#!/bin/bash

PROG=$(basename ${0})

trap kill_unit_server SIGINT SIGHUP

function kill_unit_server() {
    wget -O /dev/null -o /dev/null http://127.0.0.1:8000/shutdown &
    sleep 2
    pkill -9 -f "python3 unit/unit-server.py"
    pkill -9 -f obs.api.Lipp
}

function usage() {
    echo ""
    echo " Usage:"
    echo "  ${PROG} start|stop"
    echo ""
}

case "${1}" in
    start)
        cd /home/ocs/python/LAST_next_generation
        source .venv/bin/activate
        python3 unit/unit-server.py
        ;;

    stop)
        kill_unit_server
        ;;

    *)
        usage
        ;;
esac
